<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì™„ëŒ€ì „</title>
    <meta
      name="description"
      content="ì™„ë„ê³ ë“±í•™êµ í•™ìƒë“¤ì„ ìœ„í•œ ì›¹ ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤."
    />

    <!-- Open Graph íƒœê·¸ (ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ ìš©) -->
    <meta property="og:title" content="ì™„ëŒ€ì „" />
    <meta
      property="og:description"
      content="ì™„ë„ê³ ë“±í•™êµ í•™ìƒë“¤ì„ ìœ„í•œ ì›¹ ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤."
    />
    <meta property="og:image" content="https://wdj.kr/content.png" />
    <meta property="og:url" content="https://wdj.kr/" />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/asset/icon/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="/asset/icon/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/asset/icon/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/asset/icon/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/asset/icon/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="/asset/icon/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/asset/icon/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/asset/icon/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/asset/icon/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/asset/icon/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/asset/icon/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/asset/icon/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/asset/icon/apple-icon-180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/asset/icon/android-icon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/asset/icon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/asset/icon/favicon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/asset/icon/favicon-16x16.png"
    />
    <link rel="manifest" href="/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />
    <link
      rel="stylesheet"
      as="style"
      crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Pretendard", "sans-serif"],
            },
            colors: {
              primary: {
                50: "#E6F0FF",
                100: "#CCE0FF",
                200: "#99C2FF",
                300: "#66A3FF",
                400: "#3385FF",
                500: "#0066FF",
                600: "#0052CC",
                700: "#003D99",
                800: "#002966",
                900: "#001433",
              },
            },
          },
        },
      };
    </script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      /* ê¸°ë³¸ ëª¨ë°”ì¼ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
      #mobile-menu {
        position: fixed;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100vh;
        background-color: #2563eb;
        transition: left 0.3s ease-in-out;
        z-index: 50;
      }

      #mobile-menu.active {
        left: 0;
      }

      .mobile-menu-content {
        padding: 2rem;
        height: 100%;
        overflow-y: auto;
      }

      .mobile-menu-link {
        display: block;
        padding: 1rem;
        color: white;
        font-size: 1.125rem;
        border-radius: 0.5rem;
        transition: all 0.2s;
      }

      .mobile-menu-link:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .nav-link {
        padding: 0.5rem 0;
        position: relative;
        display: inline-block;
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: white;
        transform: scaleX(0);
        transform-origin: right;
        transition: transform 0.3s ease;
      }

      .nav-link:hover::after {
        transform: scaleX(1);
        transform-origin: left;
      }

      .nav-link.active::after {
        transform: scaleX(1);
      }

      .nav-link:hover {
        transform: translateY(-1px);
      }

      /* íˆ¬í‘œ ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
      .vote-button {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.375rem 0.75rem;
        border-radius: 0.5rem;
        transition: all 0.2s;
        min-width: 70px;
        font-size: 0.875rem;
      }

      /* íˆ¬í‘œ ë²„íŠ¼ í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
      .vote-buttons {
        display: flex;
        justify-content: center;
        gap: 0.75rem;
        padding: 0 1rem;
      }

      /* íˆ¬í‘œ ë²„íŠ¼ íƒœ */
      .vote-button:disabled {
        opacity: 0.7;
      }
      .vote-button.active {
        transform: scale(1.05);
      }

      /* ì¶”ì²œ ë²„íŠ¼ */
      .upvote-button {
        background: linear-gradient(to right, #3b82f6, #2563eb);
        color: white;
        box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
      }
      .upvote-button:hover,
      .upvote-button.active {
        background: linear-gradient(to right, #2563eb, #1d4ed8);
      }
      .upvote-button.active {
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
      }

      /* ë¹„ì¶”ì²œ ë²„íŠ¼ */
      .downvote-button {
        background: linear-gradient(to right, #ef4444, #dc2626);
        color: white;
        box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.3);
      }
      .downvote-button:hover,
      .downvote-button.active {
        background: linear-gradient(to right, #dc2626, #b91c1c);
      }
      .downvote-button.active {
        box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.3);
      }

      /* ì•„ì´ì½˜ í¬ê¸° ì • */
      .vote-button i {
        font-size: 0.9rem;
      }

      /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
      @media (max-width: 640px) {
        .vote-buttons {
          flex-direction: row;
          gap: 0.5rem;
          padding: 0 0.5rem;
        }
        .vote-button {
          flex: 1;
          padding: 0.4rem 0.8rem;
          min-width: 0;
        }
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
  </head>
  <body class="bg-gray-100 font-sans">
    <header
      class="bg-gradient-to-r from-blue-600 to-blue-700 shadow-lg py-1 mb-8 fixed w-full top-0 z-50"
    >
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-3">
          <div class="flex justify-start lg:w-0 lg:flex-1">
            <a
              href="/index.html"
              class="text-2xl font-bold text-white hover:text-gray-100 transition-all duration-300 transform hover:scale-105"
            >
              ì™„Â·ëŒ€Â·ì „
            </a>
          </div>
          <nav class="hidden md:flex space-x-8">
            <a
              href="notice.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">ê³µì§€ì‚¬í•­</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="community.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">ì»¤ë®¤ë‹ˆí‹°</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="petition.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">ì²­ì›Â·ì œì•ˆ</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="utility.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">í•™ê¸‰ ë„ìš°ë¯¸</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="about.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">ì†Œê°œ</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
          </nav>
          <div class="md:hidden">
            <button
              id="mobile-menu-button"
              class="rounded-lg p-2 inline-flex items-center justify-center text-white hover:bg-blue-500/50 transition-all duration-300"
              aria-label="ë©”ë‰´ ì—´ê¸°"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-menu" class="md:hidden">
        <div class="mobile-menu-content">
          <div class="flex justify-between items-center mb-4">
            <a href="/index.html" class="text-xl font-bold text-white"
              >ì™„Â·ëŒ€Â·ì „</a
            >
            <button
              id="mobile-menu-close"
              class="p-1.5 rounded-lg text-white hover:bg-blue-500/50 transition-all duration-300"
              aria-label="ë©”ë‰´ ë‹«ê¸°"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
            </button>
          </div>
          <nav class="space-y-2">
            <a href="notice.html" class="mobile-menu-link text-sm">ê³µì§€ì‚¬í•­</a>
            <a href="community.html" class="mobile-menu-link text-sm"
              >ì»¤ë®¤ë‹ˆí‹°</a
            >
            <a href="petition.html" class="mobile-menu-link text-sm"
              >ì²­ì›Â·ì œì•ˆ</a
            >
            <a href="utility.html" class="mobile-menu-link text-sm"
              >í•™ê¸‰ ë„ìš°ë¯¸</a
            >
            <a href="about.html" class="mobile-menu-link text-sm">ì†Œê°œ</a>
          </nav>
        </div>
      </div>
    </header>
    <main
      class="container mx-auto px-4 sm:px-6 lg:px-8 mt-20 mb-12 sm:mt-24 sm:mb-16"
    >
      <!-- ê²Œì‹œê¸€ ìƒì„¸ ë‚´ ì»¨í…Œì´ë„ˆ -->
      <div class="bg-white rounded-lg shadow-lg overflow-hidden">
        <!-- ê²Œì‹œê¸€ í—¤ë” -->
        <div class="p-4 sm:p-6">
          <div
            class="flex flex-col sm:flex-row sm:justify-between sm:items-start mb-3 sm:mb-4"
          >
            <h1
              class="text-xl sm:text-2xl font-bold mb-2 sm:mb-0"
              id="postTitle"
            ></h1>
            <div class="flex items-center space-x-3 text-sm text-gray-500">
              <span>
                <i class="far fa-eye"></i> <span id="viewCount">0</span>
              </span>
              <span>
                <i class="far fa-comment"></i> <span id="commentCount">0</span>
              </span>
            </div>
          </div>

          <div
            class="flex flex-col sm:flex-row sm:justify-between sm:items-center text-sm text-gray-600 border-b pb-3 sm:pb-4"
          >
            <div
              class="flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-1 sm:space-y-0 mb-2 sm:mb-0"
            >
              <span id="authorInfo"></span>
              <span id="postDate"></span>
              <span id="ipAddress" class="text-gray-400"></span>
            </div>
            <!-- ê´€ë¦¬ì ì „ìš© ì»¨íŠ¸ë¡¤ -->
            <div id="adminControls" class="hidden space-x-2">
              <button class="text-blue-500 hover:text-blue-700" id="viewRealIP">
                <i class="fas fa-network-wired"></i> IP ë³´ê¸°
              </button>
              <button
                class="text-yellow-500 hover:text-yellow-700"
                id="viewRealAuthor"
              >
                <i class="fas fa-user-secret"></i> ì‘ì„±ì ë³´ê¸°
              </button>
            </div>
          </div>

          <!-- ê²Œì‹œê¸€ ë‚´ìš© -->
          <div
            class="py-4 sm:py-6 min-h-[150px] sm:min-h-[200px] whitespace-pre-wrap text-sm sm:text-base"
            id="postContent"
          ></div>

          <!-- ì¶”ì²œ/ë¹„ì¶”ì²œ ë²„íŠ¼ -->
          <div
            class="flex justify-center space-x-4 py-6 sm:py-8 border-t vote-buttons"
          >
            <button
              id="upvoteButton"
              class="vote-button upvote-button text-sm sm:text-base"
            >
              <i class="fas fa-thumbs-up text-lg sm:text-xl"></i>
              <span class="vote-count">0</span>
              <span class="font-bold ml-1 sm:ml-2">ì¶”ì²œ</span>
            </button>
            <button
              id="downvoteButton"
              class="vote-button downvote-button text-sm sm:text-base"
            >
              <i class="fas fa-thumbs-down text-lg sm:text-xl"></i>
              <span class="vote-count">0</span>
              <span class="font-bold ml-1 sm:ml-2">ë¹„ì¶”ì²œ</span>
            </button>
          </div>
          <div class="text-center mt-2">
            <span class="text-lg font-bold" id="score">0</span>
          </div>

          <!-- ê²Œì‹œê¸€ ë” ë¶€ë¶„ì— ì¶”ê°€ -->
          <div class="flex justify-between items-center mt-3 sm:mt-4">
            <div class="flex space-x-2">
              <button
                onclick="history.back()"
                class="px-3 py-1.5 sm:px-4 sm:py-2 text-sm bg-gray-500 text-white rounded hover:bg-gray-600"
              >
                ëª©ë¡ìœ¼ë¡œ
              </button>
            </div>
            <div class="flex space-x-2">
              <button
                id="editPostBtn"
                class="px-3 py-1.5 sm:px-4 sm:py-2 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 hidden"
              >
                ìˆ˜ì •
              </button>
              <button
                id="deletePostBtn"
                class="px-3 py-1.5 sm:px-4 sm:py-2 text-sm bg-red-500 text-white rounded hover:bg-red-600 hidden"
              >
                ì‚­ì œ
              </button>
            </div>
          </div>

          <!-- ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ ì¶”ê°€ -->
          <div
            id="passwordModal"
            class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center"
          >
            <div class="bg-white p-6 rounded-lg w-96">
              <h3 class="text-lg font-bold mb-4">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</h3>
              <input
                type="password"
                name="postPassword"
                id="postPassword"
                class="w-full p-2 border rounded mb-4"
                placeholder="ê¸€ ì‘ì„± ì‹œ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸"
              />
              <div class="flex justify-end space-x-2">
                <button
                  onclick="closePasswordModal()"
                  class="px-4 py-2 bg-gray-500 text-white rounded"
                >
                  ì·¨ì†Œ
                </button>
                <button
                  id="confirmPasswordBtn"
                  class="px-4 py-2 bg-blue-500 text-white rounded"
                >
                  í™•ì¸
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
      <div class="mt-6 sm:mt-8">
        <h3 class="text-lg sm:text-xl font-bold mb-3 sm:mb-4">ëŒ“ê¸€</h3>
        <form id="commentForm" class="mb-4 sm:mb-6">
          <textarea
            id="commentContent"
            name="commentContent"
            class="w-full px-3 py-2 text-sm sm:text-base text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            rows="3"
            placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"
            required
          ></textarea>

          <!-- ìµëª… ëŒ“ê¸€ ì…ë ¥ í•„ìˆ˜ ìˆ˜ì • -->
          <div id="anonymousCommentFields" class="hidden mt-3 space-y-3">
            <div
              class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4"
            >
              <input
                type="text"
                name="anonymousNick"
                id="anonymousNick"
                class="flex-1 px-3 py-1.5 sm:py-2 text-sm border rounded"
                placeholder="ë‹‰ë„¤ì„ (ë¯¸ì…ë ¥ì‹œ ã…‡ã…‡)"
              />
              <input
                type="password"
                name="anonymousPassword"
                id="anonymousPassword"
                class="flex-1 px-3 py-1.5 sm:py-2 text-sm border rounded"
                placeholder="ë¹„ë°€ë²ˆí˜¸"
              />
            </div>
            <div class="text-sm text-gray-500">
              * ìµëª… ëŒ“ê¸€ ì‘ì„± ì‹œ ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.
            </div>
          </div>

          <div class="flex items-center justify-between mt-3">
            <div class="flex items-center">
              <input
                type="checkbox"
                name="isAnonymous"
                id="isAnonymous"
                class="mr-2"
              />
              <label for="isAnonymous" class="text-sm text-gray-600"
                >ìµëª…ìœ¼ë¡œ ì‘ì„±</label
              >
            </div>
            <button
              type="submit"
              class="px-4 py-1.5 sm:py-2 text-sm bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors"
            >
              ëŒ“ê¸€ ì‘ì„±
            </button>
          </div>
        </form>

        <div id="commentList" class="space-y-3">
          <!-- ëŒ“ê¸€ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ìœ¼ë¡œ ì¶”ë©ë‹ˆë‹¤ -->
        </div>
      </div>
    </main>

    <footer
      class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white py-6 md:py-10"
    >
      <div class="container mx-auto px-6 lg:px-8">
        <!-- ëª¨ë°”ì¼ìš© í‘¸í„° -->
        <div class="md:hidden space-y-3">
          <div class="flex justify-center space-x-4">
            <a
              href="pages/notice.html"
              class="text-gray-400 hover:text-blue-400 text-sm"
              >ê³µì§€ì‚¬í•­</a
            >
            <a
              href="pages/community.html"
              class="text-gray-400 hover:text-blue-400 text-sm"
              >ì»¤ë®¤ë‹ˆí‹°</a
            >
            <a
              href="pages/petition.html"
              class="text-gray-400 hover:text-blue-400 text-sm"
              >ì²­ì›Â·ì œì•ˆ</a
            >
          </div>

          <div class="text-center text-sm text-gray-400">
            <a href="mailto:sungblab@gmail.com" class="hover:text-blue-400">
              sungblab@gmail.com
            </a>
          </div>
        </div>

        <!-- ë°ìŠ¤í¬í†±ìš© í‘¸í„° -->
        <div class="hidden md:grid grid-cols-3 gap-8">
          <!-- ê¸°ì¡´ ë°ìŠ¤í¬í†± í‘¸í„° ë‚´ìš© ìœ ì§€ -->
          <div class="space-y-3">
            <h3 class="text-xl font-bold text-white mb-2">ì™„Â·ëŒ€Â·ì „</h3>
            <p class="text-gray-400 text-sm leading-relaxed">
              ì™„ë„ê³ ë“±í•™êµ í•™ìƒë“¤ì„ ìœ„í•œ<br />
              ë” ë‚˜ì€ í•™êµìƒí™œì„ ë§Œë“¤ì–´ê°€ëŠ”<br />
              ì˜¨ë¼ì¸ ì»¤ë®¤ë‹ˆí‹° í”Œë«í¼
            </p>
          </div>

          <div class="space-y-3">
            <h4 class="text-lg font-semibold text-white mb-2">ë°”ë¡œê°€ê¸°</h4>
            <ul class="space-y-1.5">
              <li>
                <a
                  href="pages/notice.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >ê³µì§€ì‚¬í•­</a
                >
              </li>
              <li>
                <a
                  href="pages/community.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >ì»¤ë®¤ë‹ˆí‹°</a
                >
              </li>
              <li>
                <a
                  href="pages/petition.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >ì²­ì›Â·ì œì•ˆ</a
                >
              </li>
              <li>
                <a
                  href="pages/utility.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >í•™ê¸‰ ë„ìš°ë¯¸</a
                >
              </li>
            </ul>
          </div>

          <div class="space-y-3">
            <h4 class="text-lg font-semibold text-white mb-2">ë¬¸ì˜ ë° ì •ì±…</h4>
            <div class="space-y-1.5">
              <p class="flex items-center text-gray-400 text-sm">
                <i class="fas fa-envelope mr-2"></i>
                <a
                  href="mailto:sungblab@gmail.com"
                  class="hover:text-blue-400 transition-colors duration-300"
                  >sungblab@gmail.com</a
                >
              </p>
              <p class="flex items-center text-gray-400 text-sm">
                <i class="fas fa-map-marker-alt mr-2"></i>
                ì „ë‚¨ ì™„ë„êµ° ì™„ë„ì ê°œí¬ë¡œ 134
              </p>
              <a
                href="/pages/privacy-policy.html"
                class="block text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
              >
                <i class="fas fa-shield-alt mr-2"></i>
                ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨
              </a>
            </div>
          </div>
        </div>

        <!-- ê³µí†µ í•˜ë‹¨ ì˜ì—­ -->
        <div class="border-t border-gray-700 mt-8 pt-6">
          <div class="flex flex-col items-center space-y-3">
            <p class="text-xs text-gray-400 text-center">
              &copy; 2024 ì™„ë„ê³ ë“±í•™êµ í•™ìƒíšŒ. All rights reserved.
            </p>
            <div class="flex space-x-4">
              <a
                href="#"
                class="text-gray-400 hover:text-blue-400 transition-colors duration-300"
              >
              </a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const mobileMenuButton = document.getElementById("mobile-menu-button");
        const mobileMenuClose = document.getElementById("mobile-menu-close");
        const mobileMenu = document.getElementById("mobile-menu");

        // ëª¨ë°”ì¼ ë©”ë‰´ ì—´ê¸°
        mobileMenuButton.addEventListener("click", () => {
          mobileMenu.classList.add("active");
        });

        // ëª¨ë°”ì¼ ë©”ë‰´ ë‹«ê¸°
        mobileMenuClose.addEventListener("click", () => {
          mobileMenu.classList.remove("active");
        });

        // ëª¨ë°”ì¼ ë©”ë‰´ í´ë¦­ì‹œ ë©”ë‰´ ë‹«ê¸°
        const mobileMenuLinks = document.querySelectorAll(".mobile-menu-link");
        mobileMenuLinks.forEach((link) => {
          link.addEventListener("click", () => {
            mobileMenu.classList.remove("active");
          });
        });
      });

      // ì „ì—­ ë³€ìˆ˜ ì„¤ì •
      const API_BASE_URL =
        "https://port-0-wdj-back-lz9cd9taff85e9dc.sel4.cloudtype.app/";
      let currentUser = JSON.parse(localStorage.getItem("user"));
      let postId = new URLSearchParams(window.location.search).get("id");

      // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
      function formatDate(date) {
        const now = new Date();
        const targetDate = new Date(date);
        const diff = now - targetDate;
        const minutes = Math.floor(diff / 60000);
        const hours = Math.floor(minutes / 60);
        const days = Math.floor(hours / 24);

        if (minutes < 1) return "ë°©ê¸ˆ ì „";
        if (minutes < 60) return `${minutes}ë¶„ ì „`;
        if (hours < 24) return `${hours}ì‹œê°„ ì „`;
        if (days < 7) return `${days}ì¼ ì „`;

        return targetDate.toLocaleDateString("ko-KR", {
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      function formatIPAddress(ip) {
        if (!ip) return "";
        // IPv6 í˜•ì‹(::ffff:127.0.0.1)ì—ì„œ IPv4 ë¶€ë¶„ë§Œ ì¶”ì¶œ
        const ipv4Match = ip.match(/(?::(\d+\.\d+\.\d+\.\d+))$/);
        const ipv4 = ipv4Match ? ipv4Match[1] : ip;

        const parts = ipv4.split(".");
        if (parts.length !== 4) return "";
        return `${parts[0]}.${parts[1]}`;
      }

      // ê²Œì‹œê¸€ ê´€ë ¨ í•¨ìˆ˜ë“¤
      async function fetchPostDetail() {
        try {
          const token = localStorage.getItem("token");
          const response = await fetch(`${API_BASE_URL}/api/posts/${postId}`, {
            headers: {
              "Content-Type": "application/json",
              Authorization: token ? `Bearer ${token}` : "",
            },
          });

          if (!response.ok) {
            throw new Error("ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
          }

          const data = await response.json();
          displayPostDetail(data);
        } catch (error) {
          console.error("ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", error);
          showError("ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
      }

      function displayPostDetail(post) {
        if (!post) return;

        // ì „ì—­ ë³€ìˆ˜ì— ê²Œì‹œê¸€ ë°ì´í„° ì €ì¥
        window.currentPost = post;

        const elements = {
          title: document.getElementById("postTitle"),
          author: document.getElementById("authorInfo"),
          date: document.getElementById("postDate"),
          views: document.getElementById("viewCount"),
          comments: document.getElementById("commentCount"),
          content: document.getElementById("postContent"),
          upvoteBtn: document.getElementById("upvoteButton"),
          downvoteBtn: document.getElementById("downvoteButton"),
          score: document.getElementById("score"),
        };

        // ê¸°ë³¸ ì •ë³´ í‘œì‹œ
        elements.title.textContent = post.title;
        if (elements.author) {
          elements.author.textContent = post.isAnonymous
            ? `${post.anonymousNick || "ã…‡ã…‡"}(${post.ipAddress || ""})`
            : post.author?.nickname || "ìµëª…";
        }

        // ë‚˜ë¨¸ì§€ ì •ë³´ í‘œì‹œ
        if (elements.date)
          elements.date.textContent = formatDate(post.createdAt);
        if (elements.views) elements.views.textContent = post.views || 0;
        if (elements.comments)
          elements.comments.textContent = post.comments?.length || 0;
        if (elements.content && post.content) {
          // Markdown ì´ë¯¸ì§€ íƒœê·¸ë¥¼ HTML img íƒœê·¸ë¡œ ë³€í™˜
          const content = post.content.replace(
            /!\[ì´ë¯¸ì§€\]\((.*?)\)/g,
            '<img src="$1" class="max-w-full h-auto my-4 rounded-lg shadow-lg" alt="ì²¨ë¶€ ì´ë¯¸ì§€" loading="lazy" onerror="this.onerror=null; this.src=\'/asset/icon/image-error.png\';" />'
          );

          elements.content.innerHTML = content
            .replace(/\n/g, "<br>")
            .replace(/&lt;/g, "<")
            .replace(/&gt;/g, ">")
            .replace(/&amp;/g, "&")
            .replace(/&quot;/g, '"')
            .replace(/&#39;/g, "'");
        }

        // íˆ¬í‘œ ìƒíƒœ í‘œì‹œ
        if (elements.upvoteBtn) {
          const upvoteCount = elements.upvoteBtn.querySelector(".vote-count");
          upvoteCount.textContent = post.upvoteCount || 0;
          elements.upvoteBtn.classList.toggle("active", post.hasUpvoted);
        }

        if (elements.downvoteBtn) {
          const downvoteCount =
            elements.downvoteBtn.querySelector(".vote-count");
          downvoteCount.textContent = post.downvoteCount || 0;
          elements.downvoteBtn.classList.toggle("active", post.hasDownvoted);
        }

        // ì ìˆ˜ í‘œì‹œ ë° ìŠ¤íƒ€ì¼ ì ìš©
        if (elements.score) {
          elements.score.textContent = post.score || 0;
          if (post.score > 0) {
            elements.score.className = "text-blue-500 font-bold";
          } else if (post.score < 0) {
            elements.score.className = "text-red-500 font-bold";
          } else {
            elements.score.className = "text-gray-500";
          }
        }

        // ë² ìŠ¤íŠ¸ê¸€ í‘œì‹œ
        if (
          post.isBest &&
          elements.title &&
          !elements.title.textContent.startsWith("ğŸ†")
        ) {
          elements.title.textContent = `ğŸ† ${elements.title.textContent}`;
        }

        setupPostButtons(post);
        if (post.comments) {
          displayComments(post.comments);
        }
      }

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • í•¨ìˆ˜ ìˆ˜
      function setupEventListeners() {
        // ì¶”ì²œ/ë¹„ì¶”ì²œ ë²„íŠ¼
        const upvoteBtn = document.getElementById("upvoteButton");
        const downvoteBtn = document.getElementById("downvoteButton");
        if (upvoteBtn) {
          upvoteBtn.addEventListener("click", () => handleVote("up"));
        }
        if (downvoteBtn) {
          downvoteBtn.addEventListener("click", () => handleVote("down"));
        }

        // ëŒ“ê¸€ í¼
        const commentForm = document.getElementById("commentForm");
        if (commentForm) {
          commentForm.addEventListener("submit", submitComment);
        }

        // ìµëª… ì²´í¬ë°•ìŠ¤
        const isAnonymousCheckbox = document.getElementById("isAnonymous");
        const anonymousFields = document.getElementById(
          "anonymousCommentFields"
        );
        if (isAnonymousCheckbox && anonymousFields) {
          isAnonymousCheckbox.addEventListener("change", function (e) {
            anonymousFields.classList.toggle("hidden", !e.target.checked);
          });
        }

        // ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ë²„íŠ¼
        const backButton = document.querySelector(
          'button[onclick="history.back()"]'
        );
        if (backButton) {
          backButton.addEventListener("click", (e) => {
            e.preventDefault();
            location.href = "community.html";
          });
        }
      }

      // ì—ëŸ¬ í‘œì‹œ í•¨ìˆ˜ ì¶”ê°€
      function showError(message) {
        const contentElement = document.getElementById("postContent");
        if (contentElement) {
          contentElement.innerHTML = `
                              <div class="text-center py-8">
                                <p class="text-red-500">${message}</p>
                                <button onclick="history.back()" class="mt-4 bg-gray-500 text-white px-4 py-2 rounded">
                                  ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                                </button>
                              </div>
                            `;
        }
      }

      // ê²Œì‹œê¸€ ë²„íŠ¼ ì œì–´ í•¨ìˆ˜ ìˆ˜ì •
      function setupPostButtons(post) {
        const editBtn = document.getElementById("editPostBtn");
        const deleteBtn = document.getElementById("deletePostBtn");

        if (!editBtn || !deleteBtn) return;

        const currentUser = JSON.parse(localStorage.getItem("user"));
        const isAdmin = currentUser && currentUser.isAdmin;

        const showButtons = () => {
          editBtn.classList.remove("hidden");
          deleteBtn.classList.remove("hidden");
        };

        if (isAdmin) {
          // ê´€ë¦¬ëŠ” ëª¨ë“  ê²Œì‹œê¸€ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
          showButtons();
          editBtn.onclick = () =>
            (location.href = `write-post.html?id=${post._id}`);
          deleteBtn.onclick = () => deletePost();
        } else if (post.isAnonymous) {
          // ìµëª… ê²Œì‹œê¸€
          showButtons();
          editBtn.onclick = () => showPasswordModal("edit");
          deleteBtn.onclick = () => showPasswordModal("delete");
        } else if (
          currentUser &&
          post.author &&
          currentUser.id === post.author._id
        ) {
          // ìì‹ ì˜ ê²Œì‹œê¸€
          showButtons();
          editBtn.onclick = () =>
            (location.href = `write-post.html?id=${post._id}`);
          deleteBtn.onclick = () => deletePost();
        }
      }

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
      document.addEventListener("DOMContentLoaded", function () {
        if (!postId) {
          showError("ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.");
          return;
        }

        // ëŒ“ê¸€ í¼ ì´íŠ¸ ë¦¬ìŠ¤ë„ˆ
        const commentForm = document.getElementById("commentForm");
        if (commentForm) {
          commentForm.addEventListener("submit", submitComment);
        }

        // ìµëª… ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        const isAnonymousCheckbox = document.getElementById("isAnonymous");
        const anonymousFields = document.getElementById(
          "anonymousCommentFields"
        );
        if (isAnonymousCheckbox && anonymousFields) {
          isAnonymousCheckbox.addEventListener("change", function (e) {
            anonymousFields.classList.toggle("hidden", !e.target.checked);
          });
        }

        setupEventListeners();
        fetchPostDetail();

        if (currentUser?.isAdmin) {
          setupAdminControls();
        }

        // ë¹„ë¡œê·¸ì¸ ì‚¬ì ì²´í¬
        if (!localStorage.getItem("token")) {
          const isAnonymousCheckbox = document.getElementById("isAnonymous");
          const anonymousFields = document.getElementById(
            "anonymousCommentFields"
          );

          if (isAnonymousCheckbox && anonymousFields) {
            isAnonymousCheckbox.checked = true;
            isAnonymousCheckbox.disabled = true;
            anonymousFields.classList.remove("hidden");
          }
        }
      });

      // ëŒ“ê¸€ ê´€ë ¨ í•¨ìˆ˜ë“¤ ì¶”ê°€
      async function submitComment(e) {
        e.preventDefault();
        const content = document.getElementById("commentContent").value;
        const isAnonymous = document.getElementById("isAnonymous").checked;

        if (!content.trim()) {
          alert("ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥ë ¥í•´ì£¼ì„¸ìš”.");
          return;
        }

        const commentData = {
          content,
          isAnonymous,
        };

        if (isAnonymous) {
          const anonymousNick = document.getElementById("anonymousNick").value;
          const anonymousPassword =
            document.getElementById("anonymousPassword").value;

          if (!anonymousPassword) {
            alert("ìµëª… ëŒ“ê¸€ ì‘ì„± ì‹œ ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.");
            return;
          }

          commentData.anonymousNick = anonymousNick || "ã…‡ã…‡";
          commentData.anonymousPassword = anonymousPassword;
        }

        try {
          const token = localStorage.getItem("token");
          const headers = {
            "Content-Type": "application/json",
          };

          // ë¡œì¸í•œ ì‚¬ìš©ìì¸ ê²½ìš°ì—ë§Œ í† í° ì¶”ê°€
          if (!isAnonymous && token) {
            headers.Authorization = `Bearer ${token}`;
          }

          const response = await fetch(
            `${API_BASE_URL}/api/posts/${postId}/comments`,
            {
              method: "POST",
              headers,
              body: JSON.stringify(commentData),
            }
          );

          if (!response.ok) {
            const error = await response.json();
            throw new Error(error.message || "ëŒ“ê¸€ ì‘ì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
          }

          // í¼ ì´ˆê¸°í™”
          document.getElementById("commentContent").value = "";
          if (isAnonymous) {
            document.getElementById("anonymousNick").value = "";
            document.getElementById("anonymousPassword").value = "";
            document.getElementById("isAnonymous").checked = false;
            document
              .getElementById("anonymousCommentFields")
              .classList.add("hidden");
          }

          // ëŒ“ê¸€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
          fetchPostDetail();
        } catch (error) {
          alert(error.message || "ëŒ“ê¸€ ì‘ì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      }

      // ëŒ“ê¸€ ëª©ë¡ í‘œì‹œ í•¨ìˆ˜
      function displayComments(comments) {
        const commentList = document.getElementById("commentList");
        if (!commentList) return;

        if (!comments || comments.length === 0) {
          commentList.innerHTML = `
            <div class="text-center py-4 text-gray-500">
              ì²« ëŒ“ê¸€ì„ ì‘ì„±í•´ë³´ì„¸ìš”.
            </div>
          `;
          return;
        }

        const currentUser = JSON.parse(localStorage.getItem("user"));

        commentList.innerHTML = comments
          .map((comment) => {
            const authorDisplay = comment.isAnonymous
              ? `${comment.anonymousNick || "ã…‡ã…‡"}${
                  comment.ipAddress ? `(${comment.ipAddress})` : ""
                }`
              : comment.author?.nickname || "ìµëª…";

            // ì‚­ì œ ë²„íŠ¼ ì‹œ ì¡°ê±´ ìˆ˜ì •
            const canDelete =
              currentUser?.isAdmin || // ê´€ë¦¬ìì´ê±°ë‚˜
              (currentUser &&
                comment.author &&
                currentUser.id === comment.author._id) || // ìì‹ ì˜ ëŒ“ê¸€ì´ê±°ë‚˜
              comment.isAnonymous; // ìµëª… ê¸€ì¸ ê²½ìš°

            const deleteButton = canDelete
              ? `<button class="text-red-500 hover:text-red-700" onclick="deleteComment('${comment._id}')">ì‚­ì œ</button>`
              : "";

            return `
              <div class="bg-gray-50 p-4 rounded-lg">
                <div class="flex justify-between items-start">
                  <div>
                    <p class="mb-2">${comment.content}</p>
                    <p class="text-sm text-gray-500">
                      <span class="font-medium">${authorDisplay}</span>
                      <span class="mx-2">|</span>
                      <span>${formatDate(comment.createdAt)}</span>
                    </p>
                  </div>
                  <div class="flex space-x-2">
                    ${deleteButton}
                  </div>
                </div>
              </div>
            `;
          })
          .join("");
      }

      // ëŒ“ê¸€ ì‚­ì œ í•¨ìˆ˜
      async function deleteComment(commentId) {
        if (!confirm("ì •ë§ë¡œ ì´ ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
          return;
        }

        try {
          const headers = {
            "Content-Type": "application/json",
          };

          // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì¸ ê²½ìš° í† í° ì¶”ê°€
          const token = localStorage.getItem("token");
          if (token) {
            headers.Authorization = `Bearer ${token}`;
          }

          // ìµëª… ëŒ“ê¸€ì¸ ê²½ìš° ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ë°›ê¸°
          let password = null;
          if (!token) {
            password = prompt("ëŒ“ê¸€ ì‘ì„±ì‹œ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            if (!password) return;
          }

          const response = await fetch(
            `${API_BASE_URL}/api/comments/${commentId}`,
            {
              method: "DELETE",
              headers,
              body: password ? JSON.stringify({ password }) : undefined,
            }
          );

          if (!response.ok) {
            const error = await response.json();
            throw new Error(error.message || "ëŒ“ê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
          }

          // ëŒ“ê¸€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
          fetchPostDetail();
        } catch (error) {
          alert(error.message || "ëŒ“ê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      }

      // ìµëª… ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ìˆ˜ì •
      document
        .getElementById("isAnonymous")
        .addEventListener("change", function (e) {
          const anonymousFields = document.getElementById(
            "anonymousCommentFields"
          );
          const anonymousPassword =
            document.getElementById("anonymousPassword");

          anonymousFields.classList.toggle("hidden", !this.checked);

          // ìµëª… ì„ íƒ ì‹œ ë¹„ë°€ë²ˆí˜¸ í•„ìˆ˜ ì„¤ì •
          if (this.checked) {
            anonymousPassword.setAttribute("required", "required");
          } else {
            anonymousPassword.removeAttribute("required");
          }
        });

      // ì¶”ì¶”ì²œì²œ/ë¹„ì¶”ì²œ ì²˜ë¦¬ í•¨ìˆ˜
      async function handleVote(type) {
        const upvoteBtn = document.getElementById("upvoteButton");
        const downvoteBtn = document.getElementById("downvoteButton");
        const scoreElement = document.getElementById("score");

        try {
          upvoteBtn.disabled = true;
          downvoteBtn.disabled = true;

          const response = await fetch(
            `${API_BASE_URL}/api/posts/${postId}/vote`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ type }),
              credentials: "include",
            }
          );

          const data = await response.json();

          if (!response.ok) {
            throw new Error(data.message);
          }

          // UI ì—…ë°ì´íŠ¸
          const upvoteCount = upvoteBtn.querySelector(".vote-count");
          const downvoteCount = downvoteBtn.querySelector(".vote-count");

          upvoteCount.textContent = data.upvotes;
          downvoteCount.textContent = data.downvotes;
          scoreElement.textContent = data.score;

          // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
          upvoteBtn.classList.toggle("active", type === "up");
          downvoteBtn.classList.toggle("active", type === "down");

          // ë² ìŠ¤íŠ¸ê¸€ í‘œì‹œ ì—…ë°ì´íŠ¸
          if (data.isBest) {
            const titleElement = document.getElementById("postTitle");
            if (titleElement && !titleElement.textContent.startsWith("ğŸ†")) {
              titleElement.textContent = `ğŸ† ${titleElement.textContent}`;
            }
          }

          // ì ìˆ˜ì— ë”°ë¥¸ ìƒíƒœ ë³€ê²½
          if (data.score > 0) {
            scoreElement.className = "text-blue-500 font-bold";
          } else if (data.score < 0) {
            scoreElement.className = "text-red-500 font-bold";
          } else {
            scoreElement.className = "text-gray-500";
          }
        } catch (error) {
          alert(error.message || "íˆ¬í‘œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        } finally {
          upvoteBtn.disabled = false;
          downvoteBtn.disabled = false;
        }
      }

      // ê´€ë¦¬ì ì»¨íŠ¸ë¡¤ ì„¤ì • í•¨ìˆ˜ ìˆ˜ì •
      function setupAdminControls() {
        const adminControls = document.getElementById("adminControls");
        if (!adminControls) return;

        const currentUser = JSON.parse(localStorage.getItem("user"));
        if (!currentUser?.isAdmin) return;

        // í˜„ì¬ ê²Œì‹œê¸€ ë°ì´í„°ê°€ ìˆê³  ìµëª… ê²Œì‹œê¸€ì¸ ê²½ìš°ì—ë§Œ ê´€ë¦¬ì ì»¨íŠ¸ë¡¤ í‘œì‹œ
        const post = window.currentPost;
        if (post && post.isAnonymous) {
          adminControls.classList.remove("hidden");

          // IP ë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
          document
            .getElementById("viewRealIP")
            .addEventListener("click", async () => {
              try {
                const token = localStorage.getItem("token");
                const response = await fetch(
                  `${API_BASE_URL}/api/posts/${postId}/ip`,
                  {
                    headers: {
                      Authorization: `Bearer ${token}`,
                    },
                  }
                );

                if (!response.ok) throw new Error("IP ì¡°íšŒ ì‹¤íŒ¨");

                const data = await response.json();
                alert(`ì‘ì„±ì IP: ${data.ipAddress}`);
              } catch (error) {
                alert("IP ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
              }
            });

          // ì‘ì„±ì ì •ë³´ ë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
          document
            .getElementById("viewRealAuthor")
            .addEventListener("click", async () => {
              try {
                const token = localStorage.getItem("token");
                const response = await fetch(
                  `${API_BASE_URL}/api/posts/${postId}/author`,
                  {
                    headers: {
                      Authorization: `Bearer ${token}`,
                    },
                  }
                );

                if (!response.ok) throw new Error("ì‘ì„±ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨");

                const data = await response.json();
                alert(
                  `ì‘ì„±ì ì •ë³´:\në‹‰ë„¤ì„: ${data.nickname}\nì•„ì´ë””: ${data.username}`
                );
              } catch (error) {
                alert("ì‘ì„±ì ì •ë³´ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
              }
            });
        }
      }

      // ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
      let currentAction = ""; // 'edit' ë˜ëŠ” 'delete'

      // ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ ì—´ê¸°
      function showPasswordModal(action) {
        currentAction = action;
        const modal = document.getElementById("passwordModal");
        const passwordInput = document.getElementById("postPassword");

        modal.classList.remove("hidden");
        passwordInput.value = "";
        passwordInput.focus();
      }

      // ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ ë‹«ê¸°
      function closePasswordModal() {
        const modal = document.getElementById("passwordModal");
        modal.classList.add("hidden");
        currentAction = "";
      }

      // ë¹„ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document
        .getElementById("confirmPasswordBtn")
        .addEventListener("click", async () => {
          const password = document.getElementById("postPassword").value;

          if (!password) {
            alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
          }

          try {
            const response = await fetch(
              `${API_BASE_URL}/api/posts/${postId}/verify-password`,
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({ password }),
              }
            );

            if (!response.ok) {
              throw new Error("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }

            // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì„±ê³µ í›„ ì‘ì—… ìˆ˜í–‰
            if (currentAction === "edit") {
              location.href = `write-post.html?id=${postId}&password=${password}`;
            } else if (currentAction === "delete") {
              await deletePost(password);
            }

            closePasswordModal();
          } catch (error) {
            alert(error.message || "ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          }
        });

      // ê²Œì‹œê¸€ ì‚­ì œ í•¨ìˆ˜
      async function deletePost(password = null) {
        if (!confirm("ì •ë§ë¡œ ì´ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
          return;
        }

        try {
          const headers = {
            "Content-Type": "application/json",
          };

          // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì¸ ê²½ìš° í† í° ì¶”ê°€
          const token = localStorage.getItem("token");
          if (token) {
            headers.Authorization = `Bearer ${token}`;
          }

          // ë¹„ë°€ë²ˆí˜¸ê°€ ìˆëŠ” ê²½ìš° ìš”ì²­ ë³¸ë¬¸ì— í¬í•¨
          const body = password ? { password } : undefined;

          const response = await fetch(`${API_BASE_URL}/api/posts/${postId}`, {
            method: "DELETE",
            headers,
            body: body ? JSON.stringify(body) : undefined,
          });

          if (!response.ok) {
            const error = await response.json();
            throw new Error(error.message || "ê²Œì‹œê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
          }

          alert("ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
          location.href = "community.html";
        } catch (error) {
          alert(error.message || "ê²Œì‹œê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      }
    </script>
  </body>
</html>
