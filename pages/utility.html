<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>완대전</title>
    <meta
      name="description"
      content="완도고등학교 학생들을 위한 웹 커뮤니티 사이트입니다."
    />

    <!-- Open Graph 태그 (소셜 미디어 공유용) -->
    <meta property="og:title" content="완대전" />
    <meta
      property="og:description"
      content="완도고등학교 학생들을 위한 웹 커뮤니티 사이트입니다."
    />
    <meta property="og:image" content="https://wdj.kr/content.png" />
    <meta property="og:url" content="https://wdj.kr/" />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/asset/icon/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="/asset/icon/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/asset/icon/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/asset/icon/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/asset/icon/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="/asset/icon/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/asset/icon/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/asset/icon/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/asset/icon/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/asset/icon/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/asset/icon/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/asset/icon/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/asset/icon/apple-icon-180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/asset/icon/android-icon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/asset/icon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/asset/icon/favicon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/asset/icon/favicon-16x16.png"
    />
    <link rel="manifest" href="/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />
    <link
      rel="stylesheet"
      as="style"
      crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Pretendard", "sans-serif"],
            },
            colors: {
              primary: {
                50: "#E6F0FF",
                100: "#CCE0FF",
                200: "#99C2FF",
                300: "#66A3FF",
                400: "#3385FF",
                500: "#0066FF",
                600: "#0052CC",
                700: "#003D99",
                800: "#002966",
                900: "#001433",
              },
            },
          },
        },
      };
    </script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      #mobile-menu {
        position: fixed;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100vh;
        background-color: #2563eb;
        transition: left 0.3s ease-in-out;
        z-index: 50;
      }

      #mobile-menu.active {
        left: 0;
      }

      .mobile-menu-content {
        padding: 2rem;
        height: 100%;
        overflow-y: auto;
      }

      .mobile-menu-link {
        display: block;
        padding: 1rem;
        color: white;
        font-size: 1.125rem;
        border-radius: 0.5rem;
        transition: all 0.2s;
      }

      .mobile-menu-link:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .nav-link {
        padding: 0.5rem 0;
        position: relative;
        display: inline-block;
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: white;
        transform: scaleX(0);
        transform-origin: right;
        transition: transform 0.3s ease;
      }

      .nav-link:hover::after {
        transform: scaleX(1);
        transform-origin: left;
      }

      .nav-link.active::after {
        transform: scaleX(1);
      }

      .nav-link:hover {
        transform: translateY(-1px);
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
  </head>
  <body class="bg-gray-100 font-sans">
    <header
      class="bg-gradient-to-r from-blue-600 to-blue-700 shadow-lg py-1 mb-8 fixed w-full top-0 z-50"
    >
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-3">
          <div class="flex justify-start lg:w-0 lg:flex-1">
            <a
              href="/index.html"
              class="text-2xl font-bold text-white hover:text-gray-100 transition-all duration-300 transform hover:scale-105"
            >
              완·대·전
            </a>
          </div>
          <nav class="hidden md:flex space-x-8">
            <a
              href="notice.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">공지사항</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="community.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">커뮤니티</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="petition.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">청원·제안</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="utility.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">학급 도우미</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
            <a
              href="about.html"
              class="nav-link group relative text-base font-medium text-white transition-all duration-300"
            >
              <span class="relative z-10">소개</span>
              <span
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"
              ></span>
            </a>
          </nav>
          <div class="md:hidden">
            <button
              id="mobile-menu-button"
              class="rounded-lg p-2 inline-flex items-center justify-center text-white hover:bg-blue-500/50 transition-all duration-300"
              aria-label="메뉴 열기"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-menu" class="md:hidden">
        <div class="mobile-menu-content">
          <div class="flex justify-between items-center mb-4">
            <a href="/index.html" class="text-xl font-bold text-white"
              >완·대·전</a
            >
            <button
              id="mobile-menu-close"
              class="p-1.5 rounded-lg text-white hover:bg-blue-500/50 transition-all duration-300"
              aria-label="메뉴 닫기"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
            </button>
          </div>
          <nav class="space-y-2">
            <a href="notice.html" class="mobile-menu-link text-sm">공지사항</a>
            <a href="community.html" class="mobile-menu-link text-sm"
              >커뮤니티</a
            >
            <a href="petition.html" class="mobile-menu-link text-sm"
              >청원·제안</a
            >
            <a href="utility.html" class="mobile-menu-link text-sm"
              >학급 도우미</a
            >
            <a href="about.html" class="mobile-menu-link text-sm">소개</a>
          </nav>
        </div>
      </div>
    </header>
    <main class="w-full sm:container mx-auto mt-8 mb-16 px-0 sm:px-8">
      <h2 class="text-3xl font-bold mb-6 text-blue-700">학급 도우미</h2>
      <div class="container mx-auto mt-8 px-4">
        <h2 class="text-3xl font-bold mb-6 text-blue-700">대포뽑기</h2>
        <div class="bg-white rounded-lg shadow-md p-6">
          <div class="mb-4">
            <label
              for="maxNumber"
              class="block text-sm font-medium text-gray-700"
              >최대 번호</label
            >
            <input
              type="number"
              id="maxNumber"
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"
              value="20"
              min="1"
              max="99"
            />
          </div>
          <div class="mb-4">
            <label
              for="allowDuplicates"
              class="block text-sm font-medium text-gray-700"
            >
              <input
                type="checkbox"
                id="allowDuplicates"
                class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-offset-0 focus:ring-blue-200 focus:ring-opacity-50"
              />
              중복 허용
            </label>
          </div>
          <button
            id="pickButton"
            class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600"
          >
            번호 뽑기
          </button>
          <button
            id="resetButton"
            class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600"
          >
            초기화
          </button>
          <div class="mt-8">
            <canvas
              id="animationCanvas"
              width="800"
              height="400"
              class="mx-auto border rounded-lg"
            ></canvas>
          </div>
          <p id="pickedNumbers" class="mt-4 text-lg">뽑은 번호:</p>
          <div id="statistics" class="mt-4"></div>
        </div>
      </div>
      <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold mb-8 text-center text-blue-600">
          타이머/스톱워치
        </h1>
        <div class="flex flex-wrap justify-center gap-8">
          <!-- 타이머 섹션 -->
          <div
            class="bg-white rounded-lg shadow-md p-6 w-full md:w-1/2 lg:w-1/3"
          >
            <h2 class="text-2xl font-bold mb-4 text-center text-blue-500">
              타이머
            </h2>
            <canvas
              id="timerCanvas"
              width="300"
              height="300"
              class="mx-auto"
            ></canvas>
            <div class="mt-4 flex justify-center items-center space-x-2">
              <input
                type="number"
                id="timerHours"
                class="border rounded px-2 py-1 w-16 text-center"
                value="0"
                min="0"
                max="23"
                placeholder="시"
              />
              <span>시</span>
              <input
                type="number"
                id="timerMinutes"
                class="border rounded px-2 py-1 w-16 text-center"
                value="5"
                min="0"
                max="59"
                placeholder="분"
              />
              <span>분</span>
              <input
                type="number"
                id="timerSeconds"
                class="border rounded px-2 py-1 w-16 text-center"
                value="0"
                min="0"
                max="59"
                placeholder="초"
              />
              <span>초</span>
            </div>
            <div class="mt-4 flex justify-center space-x-2">
              <button
                id="startTimer"
                class="bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600"
              >
                시작
              </button>
              <button
                id="resetTimer"
                class="bg-red-500 text-white px-6 py-2 rounded hover:bg-red-600"
              >
                리셋
              </button>
            </div>
          </div>
          <!-- 스톱워치 섹션 -->
          <div
            class="bg-white rounded-lg shadow-md p-6 w-full md:w-1/2 lg:w-1/3"
          >
            <h2 class="text-2xl font-bold mb-4 text-center text-blue-500">
              스톱워치
            </h2>
            <canvas
              id="stopwatchCanvas"
              width="300"
              height="300"
              class="mx-auto"
            ></canvas>
            <div class="mt-4 flex justify-center space-x-2">
              <button
                id="startStopwatch"
                class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600"
              >
                시작
              </button>
              <button
                id="stopStopwatch"
                class="bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600"
              >
                정지
              </button>
              <button
                id="resetStopwatch"
                class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
              >
                리셋
              </button>
              <button
                id="lapStopwatch"
                class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
              >
                랩
              </button>
            </div>
            <div id="lapTimes" class="mt-4 max-h-40 overflow-y-auto"></div>
          </div>
        </div>
      </div>
      <div
        class="max-w-4xl mx-auto bg-white rounded-xl shadow-md overflow-hidden p-6"
      >
        <h1 class="text-3xl font-bold mb-6 text-center text-blue-600">
          팀 생성기
        </h1>

        <div class="mb-6">
          <label class="inline-flex items-center">
            <input
              type="radio"
              class="form-radio"
              name="mode"
              value="simple"
              checked
            />
            <span class="ml-2">간단 모드</span>
          </label>
          <label class="inline-flex items-center ml-6">
            <input
              type="radio"
              class="form-radio"
              name="mode"
              value="advanced"
            />
            <span class="ml-2">고급 모드</span>
          </label>
        </div>

        <div id="simpleMode">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label
                for="totalStudents"
                class="block text-sm font-medium text-gray-700 mb-2"
                >전체 학생 수</label
              >
              <input
                type="number"
                id="totalStudents"
                min="2"
                value="20"
                class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
              />
            </div>
            <div>
              <label
                for="simpleTeamCount"
                class="block text-sm font-medium text-gray-700 mb-2"
                >팀 수</label
              >
              <input
                type="number"
                id="simpleTeamCount"
                min="2"
                value="4"
                class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
              />
            </div>
          </div>
        </div>

        <div id="advancedMode" style="display: none">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label
                for="studentNames"
                class="block text-sm font-medium text-gray-700 mb-2"
                >학생 이름 (쉼표로 구분)</label
              >
              <textarea
                id="studentNames"
                rows="4"
                class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
                placeholder="홍길동, 김철수, 이영희, ..."
              ></textarea>
            </div>
            <div>
              <label
                for="teamNames"
                class="block text-sm font-medium text-gray-700 mb-2"
                >팀 이름 (쉼표로 구분, 선택사항)</label
              >
              <textarea
                id="teamNames"
                rows="4"
                class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
                placeholder="레드팀, 블루팀, 그린팀, ..."
              ></textarea>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label
                for="advancedTeamCount"
                class="block text-sm font-medium text-gray-700 mb-2"
                >팀 수</label
              >
              <input
                type="number"
                id="advancedTeamCount"
                min="2"
                value="4"
                class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
              />
            </div>
            <div>
              <label
                for="constraints"
                class="block text-sm font-medium text-gray-700 mb-2"
                >제약 조건 (이름:팀번호, 쉼표로 구분) - 팀 조장을 특정하는
                기능</label
              >
              <input
                type="text"
                id="constraints"
                class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
                placeholder="홍길동:1, 김철수:2, 이영희:!2"
              />
            </div>
          </div>
        </div>

        <div class="flex justify-center space-x-4 mb-6">
          <button
            id="generateTeams"
            class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50"
          >
            팀 생성
          </button>
          <button
            id="saveTeamsImage"
            class="px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"
          >
            결과 이미지 저장
          </button>
        </div>

        <canvas
          id="teamsCanvas"
          width="800"
          height="400"
          class="mx-auto border rounded-lg"
        ></canvas>
      </div>
    </main>

    <footer
      class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white py-2 md:py-4"
    >
      <div class="container mx-auto px-6 lg:px-8">
        <!-- 모바일용 푸터 -->
        <div class="md:hidden space-y-3">
          <div class="flex justify-center space-x-4">
            <a
              href="pages/notice.html"
              class="text-gray-400 hover:text-blue-400 text-sm"
              >공지사항</a
            >
            <a
              href="pages/community.html"
              class="text-gray-400 hover:text-blue-400 text-sm"
              >커뮤니티</a
            >
            <a
              href="pages/petition.html"
              class="text-gray-400 hover:text-blue-400 text-sm"
              >청원·제안</a
            >
          </div>

          <div class="text-center text-sm text-gray-400">
            <a href="mailto:sungblab@gmail.com" class="hover:text-blue-400">
              sungblab@gmail.com
            </a>
          </div>
        </div>

        <!-- 데스크톱용 푸터 -->
        <div class="hidden md:grid grid-cols-3 gap-8">
          <!-- 기존 데스크톱 푸터 내용 유지 -->
          <div class="space-y-3">
            <h3 class="text-xl font-bold text-white mb-2">완·대·전</h3>
            <p class="text-gray-400 text-sm leading-relaxed">
              완도고등학교 학생들을 위한<br />
              더 나은 학교생활을 만들어가는<br />
              온라인 커뮤니티 플랫폼
            </p>
          </div>

          <div class="space-y-3">
            <h4 class="text-lg font-semibold text-white mb-2">바로가기</h4>
            <ul class="space-y-1.5">
              <li>
                <a
                  href="pages/notice.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >공지사항</a
                >
              </li>
              <li>
                <a
                  href="pages/community.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >커뮤니티</a
                >
              </li>
              <li>
                <a
                  href="pages/petition.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >청원·제안</a
                >
              </li>
              <li>
                <a
                  href="pages/utility.html"
                  class="text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
                  >학급 도우미</a
                >
              </li>
            </ul>
          </div>

          <div class="space-y-3">
            <h4 class="text-lg font-semibold text-white mb-2">문의 및 정책</h4>
            <div class="space-y-1.5">
              <p class="flex items-center text-gray-400 text-sm">
                <i class="fas fa-envelope mr-2"></i>
                <a
                  href="mailto:sungblab@gmail.com"
                  class="hover:text-blue-400 transition-colors duration-300"
                  >sungblab@gmail.com</a
                >
              </p>
              <p class="flex items-center text-gray-400 text-sm">
                <i class="fas fa-map-marker-alt mr-2"></i>
                전남 완도군 완도읍 개포로 134
              </p>
              <a
                href="/pages/privacy-policy.html"
                class="block text-gray-400 hover:text-blue-400 transition-colors duration-300 text-sm"
              >
                <i class="fas fa-shield-alt mr-2"></i>
                개인정보 처리방침
              </a>
            </div>
          </div>
        </div>

        <!-- 공통 하단 영역 -->
        <div class="border-t border-gray-700 mt-8 pt-6">
          <div class="flex flex-col items-center space-y-3">
            <p class="text-xs text-gray-400 text-center">
              &copy; 2024 CodeLab. All rights reserved.
            </p>
            <div class="flex space-x-4">
              <a
                href="#"
                class="text-gray-400 hover:text-blue-400 transition-colors duration-300"
              >
              </a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script>
      const mobileMenuButton = document.getElementById("mobile-menu-button");
      const mobileMenuClose = document.getElementById("mobile-menu-close");
      const mobileMenu = document.getElementById("mobile-menu");

      mobileMenuButton.addEventListener("click", () => {
        mobileMenu.classList.toggle("active");
      });

      mobileMenuClose.addEventListener("click", () => {
        mobileMenu.classList.remove("active");
      });

      const canvas = document.getElementById("animationCanvas");
      const ctx = canvas.getContext("2d");

      let pickedNumbers = [];
      let isAnimating = false;

      function drawScene() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // 배경 (하늘)
        let gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        gradient.addColorStop(0, "#87CEEB");
        gradient.addColorStop(1, "#E0F6FF");
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // 언덕
        ctx.fillStyle = "#4CAF50";
        ctx.beginPath();
        ctx.moveTo(0, 400);
        ctx.quadraticCurveTo(200, 350, 400, 400);
        ctx.quadraticCurveTo(600, 450, 800, 400);
        ctx.lineTo(800, 400);
        ctx.lineTo(0, 400);
        ctx.closePath();
        ctx.fill();

        // 대포 그리기
        drawCannon();
      }

      function drawCannon() {
        // 대포 바퀴
        ctx.fillStyle = "#8B4513";
        ctx.beginPath();
        ctx.arc(100, 380, 20, 0, Math.PI * 2);
        ctx.fill();

        // 대포 몸체
        ctx.fillStyle = "#333";
        ctx.beginPath();
        ctx.moveTo(60, 380);
        ctx.lineTo(140, 380);
        ctx.lineTo(130, 340);
        ctx.lineTo(70, 340);
        ctx.closePath();
        ctx.fill();

        // 대포 포신
        ctx.fillStyle = "#666";
        ctx.beginPath();
        ctx.moveTo(100, 340);
        ctx.lineTo(180, 300);
        ctx.lineTo(180, 320);
        ctx.lineTo(100, 360);
        ctx.closePath();
        ctx.fill();
      }

      function drawNumber(number, x, y, size = 50) {
        // 공 그리기
        ctx.fillStyle = `hsl(${number * 20}, 70%, 50%)`;
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();

        // 그림자 효과
        ctx.shadowColor = "rgba(0, 0, 0, 0.3)";
        ctx.shadowBlur = 5;
        ctx.shadowOffsetX = 3;
        ctx.shadowOffsetY = 3;

        // 번호 그리기
        ctx.fillStyle = "#FFFFFF";
        ctx.font = `bold ${size * 0.7}px Arial`;
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(number, x, y);

        // 그림자 초기화
        ctx.shadowColor = "transparent";
        ctx.shadowBlur = 0;
        ctx.shadowOffsetX = 0;
        ctx.shadowOffsetY = 0;
      }

      function easeOutBounce(t) {
        const n1 = 7.5625;
        const d1 = 2.75;

        if (t < 1 / d1) {
          return n1 * t * t;
        } else if (t < 2 / d1) {
          return n1 * (t -= 1.5 / d1) * t + 0.75;
        } else if (t < 2.5 / d1) {
          return n1 * (t -= 2.25 / d1) * t + 0.9375;
        } else {
          return n1 * (t -= 2.625 / d1) * t + 0.984375;
        }
      }

      function animateNumber(number) {
        let startTime;
        const duration = 300;
        const startX = 180;
        const startY = 310;
        const endX = 400;
        const endY = 200;

        function animate(currentTime) {
          if (!startTime) startTime = currentTime;
          let progress = (currentTime - startTime) / duration;

          if (progress < 1) {
            drawScene();
            let x = startX + (endX - startX) * progress;
            let y =
              startY -
              200 * Math.sin(progress * Math.PI) +
              (endY - startY) * easeOutBounce(progress);
            let size = 50 - 20 * progress; // 공이 멀어질수록 작아지는 효과
            drawNumber(number, x, y, size);
            requestAnimationFrame(animate);
          } else {
            drawScene();
            drawNumber(number, endX, endY, 30);
            isAnimating = false;
            document.getElementById("pickButton").disabled = false;
            updateStatistics();
          }
        }

        requestAnimationFrame(animate);
      }

      function pickNumber() {
        if (isAnimating) return;

        const maxNumber = parseInt(document.getElementById("maxNumber").value);
        const allowDuplicates =
          document.getElementById("allowDuplicates").checked;

        if (!allowDuplicates && pickedNumbers.length >= maxNumber) {
          alert("모든 번호를 뽑았습니다!");
          return;
        }

        let number;
        do {
          number = Math.floor(Math.random() * maxNumber) + 1;
        } while (!allowDuplicates && pickedNumbers.includes(number));

        pickedNumbers.push(number);
        document.getElementById("pickedNumbers").textContent =
          "뽑은 번호: " + pickedNumbers.join(", ");

        isAnimating = true;
        document.getElementById("pickButton").disabled = true;
        animateNumber(number);
      }

      function resetGame() {
        pickedNumbers = [];
        document.getElementById("pickedNumbers").textContent = "뽑은 번호: ";
        drawScene();
        updateStatistics();
      }

      function updateStatistics() {
        const statsContainer = document.getElementById("statistics");
        statsContainer.innerHTML = "";

        if (pickedNumbers.length > 0) {
          const counts = {};
          const maxNumber = parseInt(
            document.getElementById("maxNumber").value
          );
          for (let i = 1; i <= maxNumber; i++) {
            counts[i] = 0;
          }
          pickedNumbers.forEach((num) => {
            counts[num]++;
          });

          const sortedCounts = Object.entries(counts).sort(
            (a, b) => b[1] - a[1]
          );
          const mostPicked = sortedCounts[0];
          const leastPicked =
            sortedCounts.filter((item) => item[1] > 0).pop() ||
            sortedCounts[sortedCounts.length - 1];

          let statsHTML = '<h3 class="text-xl font-bold mb-2">통계</h3>';
          statsHTML += '<ul class="list-disc pl-5 space-y-2">';
          statsHTML += `<li>총 뽑은 횟수: ${pickedNumbers.length}</li>`;
          statsHTML += `<li>가장 많이 뽑힌 번호: ${mostPicked[0]} (${mostPicked[1]}회)</li>`;
          statsHTML += `<li>가장 적게 뽑힌 번호: ${leastPicked[0]} (${leastPicked[1]}회)</li>`;
          statsHTML += `<li>평균 뽑힌 횟수: ${(
            pickedNumbers.length / maxNumber
          ).toFixed(2)}회</li>`;
          statsHTML += "</ul>";

          // 번호별 뽑힌 횟수 차트
          statsHTML +=
            '<div class="mt-4"><h4 class="text-lg font-semibold mb-2">번호별 뽑힌 횟수</h4>';
          statsHTML += '<div class="flex flex-wrap">';
          for (let i = 1; i <= maxNumber; i++) {
            const height = counts[i] * 20; // 20px per count
            statsHTML += `<div class="w-8 mr-1 mb-1 flex flex-col items-center">
                      <div class="bg-blue-500" style="height: ${height}px; width: 20px;"></div>
                      <span class="text-xs">${i}</span>
                  </div>`;
          }
          statsHTML += "</div></div>";

          statsContainer.innerHTML = statsHTML;
        }
      }

      document
        .getElementById("pickButton")
        .addEventListener("click", pickNumber);
      document
        .getElementById("resetButton")
        .addEventListener("click", resetGame);

      // 초기 화면 그리기
      drawScene();

      // 타이머 관련 변수
      let timerDuration = 0;
      let timerRemaining = 0;
      let timerInterval;
      let isTimerRunning = false;

      // 스톱워치 관련 변수
      let stopwatchTime = 0;
      let stopwatchInterval;
      let isStopwatchRunning = false;
      let lapTimes = [];

      // 캔버스 관련 변수
      const timerCanvas = document.getElementById("timerCanvas");
      const stopwatchCanvas = document.getElementById("stopwatchCanvas");
      const timerCtx = timerCanvas.getContext("2d");
      const stopwatchCtx = stopwatchCanvas.getContext("2d");

      // 타이머 함수
      function startTimer() {
        if (!isTimerRunning) {
          if (timerRemaining === 0) {
            timerDuration = getTimerInput();
            timerRemaining = timerDuration;
          }
          timerInterval = setInterval(updateTimer, 1000);
          isTimerRunning = true;
          document.getElementById("startTimer").textContent = "일시정지";
        } else {
          clearInterval(timerInterval);
          isTimerRunning = false;
          document.getElementById("startTimer").textContent = "시작";
        }
      }

      function resetTimer() {
        clearInterval(timerInterval);
        isTimerRunning = false;
        timerRemaining = 0;
        document.getElementById("startTimer").textContent = "시작";
        updateTimerDisplay();
      }

      function updateTimer() {
        if (timerRemaining > 0) {
          timerRemaining--;
          updateTimerDisplay();
        } else {
          clearInterval(timerInterval);
          isTimerRunning = false;
          document.getElementById("startTimer").textContent = "시작";
          playAlarm();
        }
      }

      function getTimerInput() {
        const hours =
          parseInt(document.getElementById("timerHours").value) || 0;
        const minutes =
          parseInt(document.getElementById("timerMinutes").value) || 0;
        const seconds =
          parseInt(document.getElementById("timerSeconds").value) || 0;
        return hours * 3600 + minutes * 60 + seconds;
      }

      function updateTimerDisplay() {
        timerCtx.clearRect(0, 0, timerCanvas.width, timerCanvas.height);

        const centerX = timerCanvas.width / 2;
        const centerY = timerCanvas.height / 2;
        const radius = Math.min(centerX, centerY) - 10;

        // 배경 원
        timerCtx.beginPath();
        timerCtx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        timerCtx.fillStyle = "#f0f0f0";
        timerCtx.fill();

        // 진행 상태
        if (timerDuration > 0) {
          const progress = 1 - timerRemaining / timerDuration;
          timerCtx.beginPath();
          timerCtx.arc(
            centerX,
            centerY,
            radius,
            -Math.PI / 2,
            -Math.PI / 2 + progress * 2 * Math.PI
          );
          timerCtx.strokeStyle = "#3b82f6";
          timerCtx.lineWidth = 15;
          timerCtx.stroke();
        }

        // 시간 표시
        const hours = Math.floor(timerRemaining / 3600);
        const minutes = Math.floor((timerRemaining % 3600) / 60);
        const seconds = timerRemaining % 60;

        timerCtx.font = "bold 48px Arial";
        timerCtx.fillStyle = "#333";
        timerCtx.textAlign = "center";
        timerCtx.textBaseline = "middle";
        timerCtx.fillText(
          `${hours.toString().padStart(2, "0")}:${minutes
            .toString()
            .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`,
          centerX,
          centerY
        );
      }

      // 스톱워치 함수
      function startStopwatch() {
        if (!isStopwatchRunning) {
          stopwatchInterval = setInterval(updateStopwatch, 10);
          isStopwatchRunning = true;
          document.getElementById("startStopwatch").textContent = "일시정지";
        } else {
          clearInterval(stopwatchInterval);
          isStopwatchRunning = false;
          document.getElementById("startStopwatch").textContent = "시작";
        }
      }

      function stopStopwatch() {
        if (isStopwatchRunning) {
          clearInterval(stopwatchInterval);
          isStopwatchRunning = false;
          document.getElementById("startStopwatch").textContent = "시작";
        }
      }

      function resetStopwatch() {
        clearInterval(stopwatchInterval);
        isStopwatchRunning = false;
        stopwatchTime = 0;
        lapTimes = [];
        document.getElementById("startStopwatch").textContent = "시작";
        updateStopwatchDisplay();
        updateLapTimesDisplay();
      }

      function updateStopwatch() {
        stopwatchTime++;
        updateStopwatchDisplay();
      }

      function lapStopwatch() {
        if (isStopwatchRunning) {
          lapTimes.push(stopwatchTime);
          updateLapTimesDisplay();
        }
      }

      function updateStopwatchDisplay() {
        stopwatchCtx.clearRect(
          0,
          0,
          stopwatchCanvas.width,
          stopwatchCanvas.height
        );

        const centerX = stopwatchCanvas.width / 2;
        const centerY = stopwatchCanvas.height / 2;
        const radius = Math.min(centerX, centerY) - 10;

        // 배경 원
        stopwatchCtx.beginPath();
        stopwatchCtx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        stopwatchCtx.fillStyle = "#f0f0f0";
        stopwatchCtx.fill();

        // 진행 상태 (1초마다 한 바퀴)
        const progress = (stopwatchTime % 100) / 100;
        stopwatchCtx.beginPath();
        stopwatchCtx.arc(
          centerX,
          centerY,
          radius,
          -Math.PI / 2,
          -Math.PI / 2 + progress * 2 * Math.PI
        );
        stopwatchCtx.strokeStyle = "#3b82f6";
        stopwatchCtx.lineWidth = 15;
        stopwatchCtx.stroke();

        // 시간 표시
        const minutes = Math.floor(stopwatchTime / 6000);
        const seconds = Math.floor((stopwatchTime % 6000) / 100);
        const milliseconds = stopwatchTime % 100;

        stopwatchCtx.font = "bold 48px Arial";
        stopwatchCtx.fillStyle = "#333";
        stopwatchCtx.textAlign = "center";
        stopwatchCtx.textBaseline = "middle";
        stopwatchCtx.fillText(
          `${minutes.toString().padStart(2, "0")}:${seconds
            .toString()
            .padStart(2, "0")}.${milliseconds.toString().padStart(2, "0")}`,
          centerX,
          centerY
        );
      }

      function updateLapTimesDisplay() {
        const lapTimesContainer = document.getElementById("lapTimes");
        lapTimesContainer.innerHTML = "";

        lapTimes.forEach((lapTime, index) => {
          const lapElement = document.createElement("div");
          lapElement.textContent = `Lap ${index + 1}: ${formatTime(lapTime)}`;
          lapTimesContainer.appendChild(lapElement);
        });
      }

      function formatTime(time) {
        const minutes = Math.floor(time / 6000);
        const seconds = Math.floor((time % 6000) / 100);
        const milliseconds = time % 100;
        return `${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}.${milliseconds.toString().padStart(2, "0")}`;
      }

      // 알람 소리 재생
      function playAlarm() {
        alert("타이머가 종료되었습니다!");
      }

      // 이벤트 리스너 설정
      document
        .getElementById("startTimer")
        .addEventListener("click", startTimer);
      document
        .getElementById("resetTimer")
        .addEventListener("click", resetTimer);
      document
        .getElementById("startStopwatch")
        .addEventListener("click", startStopwatch);
      document
        .getElementById("stopStopwatch")
        .addEventListener("click", stopStopwatch);
      document
        .getElementById("resetStopwatch")
        .addEventListener("click", resetStopwatch);
      document
        .getElementById("lapStopwatch")
        .addEventListener("click", lapStopwatch);

      // 초기 표시 업데이트
      updateTimerDisplay();
      updateStopwatchDisplay();

      // 입력 필드 변경 시 타이머 업데이트
      ["timerHours", "timerMinutes", "timerSeconds"].forEach((id) => {
        document.getElementById(id).addEventListener("input", () => {
          if (!isTimerRunning) {
            timerDuration = getTimerInput();
            timerRemaining = timerDuration;
            updateTimerDisplay();
          }
        });
      });

      const modeRadios = document.querySelectorAll('input[name="mode"]');
      const simpleModeDiv = document.getElementById("simpleMode");
      const advancedModeDiv = document.getElementById("advancedMode");
      const totalStudentsInput = document.getElementById("totalStudents");
      const studentNamesInput = document.getElementById("studentNames");
      const teamNamesInput = document.getElementById("teamNames");
      const simpleTeamCountInput = document.getElementById("simpleTeamCount");
      const advancedTeamCountInput =
        document.getElementById("advancedTeamCount");
      const constraintsInput = document.getElementById("constraints");
      const generateTeamsBtn = document.getElementById("generateTeams");

      const teamsCanvas = document.getElementById("teamsCanvas");
      const teamsCtx = teamsCanvas.getContext("2d");

      let currentTeams = [];

      modeRadios.forEach((radio) => {
        radio.addEventListener("change", toggleMode);
      });

      generateTeamsBtn.addEventListener("click", generateAndDrawTeams);

      function toggleMode() {
        if (this.value === "simple") {
          simpleModeDiv.style.display = "block";
          advancedModeDiv.style.display = "none";
        } else {
          simpleModeDiv.style.display = "none";
          advancedModeDiv.style.display = "block";
        }
      }

      function generateAndDrawTeams() {
        try {
          const isSimpleMode =
            document.querySelector('input[name="mode"]:checked').value ===
            "simple";
          let studentNames, teamCount, teamNames, constraints;

          if (isSimpleMode) {
            const totalStudents = parseInt(totalStudentsInput.value);
            teamCount = parseInt(simpleTeamCountInput.value);
            studentNames = Array.from(
              { length: totalStudents },
              (_, i) => `학생${i + 1}`
            );
            teamNames = [];
            constraints = {};
          } else {
            studentNames = studentNamesInput.value
              .split(",")
              .map((name) => name.trim())
              .filter((name) => name);
            teamCount = parseInt(advancedTeamCountInput.value);
            teamNames = teamNamesInput.value
              .split(",")
              .map((name) => name.trim())
              .filter((name) => name);
            constraints = parseConstraints(constraintsInput.value);
          }

          if (teamCount > studentNames.length) {
            alert("팀 수가 전체 학생 수보다 많을 수 없습니다.");
            return;
          }

          currentTeams = createRandomTeams(
            studentNames,
            teamCount,
            constraints
          );
          animateTeamFormation(currentTeams, teamNames);
        } catch (error) {
          handleError(error);
        }
      }

      function parseConstraints(constraintsString) {
        const constraints = {};
        constraintsString.split(",").forEach((constraint) => {
          const [name, team] = constraint.split(":").map((s) => s.trim());
          if (name && team) {
            constraints[name] = team.startsWith("!")
              ? { not: parseInt(team.slice(1)) }
              : parseInt(team);
          }
        });
        return constraints;
      }

      function createRandomTeams(students, teamCount, constraints) {
        let unassignedStudents = [...students];
        const teams = Array.from({ length: teamCount }, () => []);

        // 제약 조건에 따라 학생 배정
        Object.entries(constraints).forEach(([student, teamConstraint]) => {
          const studentIndex = unassignedStudents.indexOf(student);
          if (studentIndex !== -1) {
            if (typeof teamConstraint === "number") {
              teams[teamConstraint - 1].push(student);
            }
            unassignedStudents.splice(studentIndex, 1);
          }
        });

        // 나머지 학생들 무작위 배정
        unassignedStudents = unassignedStudents.sort(() => Math.random() - 0.5);
        let teamIndex = 0;
        unassignedStudents.forEach((student) => {
          while (
            constraints[student] &&
            constraints[student].not === teamIndex + 1
          ) {
            teamIndex = (teamIndex + 1) % teamCount;
          }
          teams[teamIndex].push(student);
          teamIndex = (teamIndex + 1) % teamCount;
        });

        return teams;
      }

      // 애니메이션 함수
      function animateTeamFormation(teams, teamNames) {
        const duration = 1000; // 애니메이션 지속 시간 (밀리초)
        const frameRate = 60;
        const frames = duration / (1000 / frameRate);
        let frame = 0;

        function animate() {
          const progress = frame / frames;
          drawTeams(teams, teamNames, progress);
          frame++;

          if (frame <= frames) {
            requestAnimationFrame(animate);
          }
        }

        animate();
      }

      function drawTeams(teams, teamNames, progress = 1) {
        teamsCtx.clearRect(0, 0, teamsCanvas.width, teamsCanvas.height);

        const teamWidth = teamsCanvas.width / teams.length;
        const maxTeamSize = Math.max(...teams.map((team) => team.length));

        // 배경 그라데이션
        const gradient = teamsCtx.createLinearGradient(
          0,
          0,
          teamsCanvas.width,
          teamsCanvas.height
        );
        gradient.addColorStop(0, "#f3e7e9");
        gradient.addColorStop(1, "#e3eeff");
        teamsCtx.fillStyle = gradient;
        teamsCtx.fillRect(0, 0, teamsCanvas.width, teamsCanvas.height);

        teams.forEach((team, teamIndex) => {
          const teamX = teamIndex * teamWidth;

          // 팀 배경
          teamsCtx.fillStyle = `hsla(${
            (teamIndex * 360) / teams.length
          }, 70%, 60%, ${0.2 * progress})`;
          teamsCtx.beginPath();
          teamsCtx.roundRect(
            teamX + 10,
            10,
            teamWidth - 20,
            teamsCanvas.height - 20,
            15
          );
          teamsCtx.fill();

          // 팀 이름
          const teamName = teamNames[teamIndex] || `Team ${teamIndex + 1}`;
          teamsCtx.fillStyle = `hsl(${
            (teamIndex * 360) / teams.length
          }, 70%, 40%)`;
          teamsCtx.font = "bold 24px Arial";
          teamsCtx.textAlign = "center";
          teamsCtx.fillText(teamName, teamX + teamWidth / 2, 50);

          // 학생 아이콘 그리기
          team.forEach((student, studentIndex) => {
            const cols = Math.ceil(Math.sqrt(team.length));
            const rows = Math.ceil(team.length / cols);
            const cellWidth = (teamWidth - 40) / cols;
            const cellHeight = (teamsCanvas.height - 100) / rows;

            const col = studentIndex % cols;
            const row = Math.floor(studentIndex / cols);

            const targetX = teamX + 20 + col * cellWidth + cellWidth / 2;
            const targetY = 80 + row * cellHeight + cellHeight / 2;

            // 애니메이션 적용
            const startX = teamsCanvas.width / 2;
            const startY = teamsCanvas.height / 2;
            const currentX = startX + (targetX - startX) * progress;
            const currentY = startY + (targetY - startY) * progress;

            // 학생 아이콘 배경
            teamsCtx.fillStyle = `hsla(${
              (teamIndex * 360) / teams.length
            }, 70%, 60%, ${0.8 * progress})`;
            teamsCtx.beginPath();
            teamsCtx.arc(
              currentX,
              currentY,
              Math.min(cellWidth, cellHeight) / 2 - 5,
              0,
              2 * Math.PI
            );
            teamsCtx.fill();

            // 학생 이름
            teamsCtx.fillStyle = "white";
            teamsCtx.font = "bold 12px Arial";
            teamsCtx.textAlign = "center";
            teamsCtx.textBaseline = "middle";
            teamsCtx.fillText(student, currentX, currentY);
          });
        });
      }

      const saveTeamsImageBtn = document.getElementById("saveTeamsImage");
      saveTeamsImageBtn.addEventListener("click", saveTeamsAsImage);

      function saveTeamsAsImage() {
        const canvas = document.getElementById("teamsCanvas");

        // 캔버스 내용을 이미지 URL로 변환
        const imageURL = canvas.toDataURL("image/png");

        // 다운로드 링크 생성
        const downloadLink = document.createElement("a");
        downloadLink.href = imageURL;
        downloadLink.download = "team_formation.png";

        // 링크를 문서에 추가하고 클릭 이벤트 발생
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
      }

      // 에러 처리 함수
      function handleError(error) {
        console.error("An error occurred:", error);
        alert("팀 생성 중 오류가 발생했습니다. 콘솔을 확인해주세요.");
      }

      // 이벤트 리스너 추가
      document.addEventListener("DOMContentLoaded", () => {
        const generateTeamsBtn = document.getElementById("generateTeams");
        generateTeamsBtn.addEventListener("click", generateAndDrawTeams);

        // 초기 모드 설정
        const initialMode = document.querySelector(
          'input[name="mode"]:checked'
        ).value;
        if (initialMode === "simple") {
          simpleModeDiv.style.display = "block";
          advancedModeDiv.style.display = "none";
        } else {
          simpleModeDiv.style.display = "none";
          advancedModeDiv.style.display = "block";
        }
      });
    </script>
  </body>
</html>
